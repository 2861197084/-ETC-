# ETC高速公路大数据平台：实施分工与角色交付物清单

> 本文档用于项目落地实施分工。按角色列出“最终需要实现的内容”和“可验收交付物”，不按天/不按迭代拆分。适用于课程项目或小型工程团队。

---

## 1. 总体交付目标（所有角色共同达成）

系统需完成并可演示以下能力：

1. **数据接入与扩充**：基于样例数据完成扩充生成，持续 **≥50条/秒** 写入 Kafka。
2. **实时预处理**：去重、补全、标准化、字典映射、异常数据识别。
3. **存储与查询**：

   * HBase 支撑明细与时序点查/范围扫描（按车牌、按门架/卡口时间窗）。
   * MySQL（可带分片中间件 ShardingSphere/MyCat）支撑聚合指标、告警、工单等结构化业务数据。
4. **可视化大屏**：30秒刷新，地图联动（至少一级下钻）、TOP榜、告警滚动。
5. **交互式查询工作台**：多条件筛选、明细表格、导出。
6. **典型业务场景**：

   * 套牌车检测（实时告警 + 证据链 + 处置状态）。
   * 车流预警/预测（规则或模型均可，展示预测曲线与建议）。

---

## 2. 角色划分与最终交付物

### 2.1 技术负责人（TL / 架构负责人）

**最终需要实现的内容**

* 统一系统架构与技术选型：Kafka、Flink、HBase、MySQL/分片中间件、Redis（可选）、前端技术栈。
* 统一数据口径与字段模型：定义“过车事件、交易、告警、聚合指标、维表”的统一字段与含义。
* 建立工程规范：代码结构、分支策略、提交规范、配置管理、日志规范、错误码规范。
* 组织接口契约：推动后端与前端签署 OpenAPI；推动数据工程与存储签署 Schema/DDL。
* 最终验收与演示脚本：保障系统可复现、可演示、可答辩。

**可验收交付物**

* 《系统架构图 + 数据流图 + 模块边界说明》
* 《统一数据字典与字段映射表》（含课程样例字段映射，如 GCXH/XZQHMC/KKMC/FXLX/GCSJ/HPZL/车牌脱敏/CLPPXH）
* 《接口契约（OpenAPI/Swagger）总纲》与版本管理说明
* 《工程规范》：日志 trace_id、配置分层（dev/test/prod）、异常处理规范
* 《最终验收清单》与《演示脚本》

---

### 2.2 数据工程师（Kafka + Flink 实时链路）

**最终需要实现的内容**

1. **数据生成与扩充**

* 基于样例数据构造合成数据分布，持续产生 **≥50条/秒** 事件。
* 支持“异常样本开关”：

  * 套牌样本（同车牌短时间跨区域不可能到达）。
  * 拥堵样本（某站点/路段流量突增）。
* 统一输出 JSON/Avro（建议 JSON+Schema），写入 Kafka Topic。

2. **实时ETL清洗作业**

* 去重（event_id 或 plate+gantry+time_window）
* 缺失补全（字典补齐、默认值、时间纠偏）
* 字典映射（方向、号牌种类等）
* 输出：

  * HBase 明细（时序/索引表）
  * MySQL 聚合指标（分钟/5分钟滚动等）

3. **实时告警作业（套牌检测/拥堵预警）**

* 套牌检测：基于事件时间窗口 + 地理距离 + 速度上限判断，产出告警与证据链。
* 拥堵预警：流量/速度阈值或历史基线对比，产出预警事件。

**可验收交付物**

* 数据生成器：可配置 QPS、区域/站点分布、异常比例、输出 Topic
* Kafka Topic 清单与消息 Schema 文件（`schema/*.json`）
* Flink 作业（至少三类）：ETL、聚合、告警
* 运行证明：Flink Web UI 截图/日志，显示吞吐与延迟（演示版即可）

---

### 2.3 存储与数据模型工程师（HBase + MySQL/分片）

**最终需要实现的内容**

1. **HBase 表设计与索引策略**

* 至少完成两类访问路径：

  * 按车牌查最近 N 条（轨迹回放/点查）。
  * 按门架/卡口在时间窗范围 scan（区域态势/统计）。
* RowKey 设计：防热点（salt）、支持倒序时间（reverse_ts）或前缀扫描。
* 列族规划：明细字段族、扩展字段族、证据链字段族（按需）。

2. **MySQL 业务表与聚合表设计**

* 表必须覆盖：

  * 聚合指标（站点/路段分钟级、TOP榜来源）。
  * 告警事件与处置状态（含证据链引用）。
  * 工单/处置记录（可选但推荐）。
  * 维表（站点、门架、路段、行政区划等）。
* 若使用分片：

  * 给出 ShardingSphere/MyCat 的分片规则（按 region、按月份 yyyyMM 分表等）。

3. **数据一致性与落库规范**

* 给出字段类型、索引、主键策略。
* 定义数据保留策略（明细、聚合、告警）。

**可验收交付物**

* 《HBase 表结构与 RowKey 设计说明》
* HBase 建表脚本（`hbase_shell` 或初始化脚本）
* MySQL DDL（含索引）+（可选）分片配置文件
* 字段映射：从 Kafka/Flink 输出到存储表字段的对照表

---

### 2.4 后端工程师（API 与业务服务）

**最终需要实现的内容**

1. **统一查询服务**

* 支撑大屏与工作台的核心查询：

  * 大屏概览：`/dashboard/overview`（聚合指标、TOP榜、告警概览、刷新时间）
  * 车牌查询：最近轨迹、时间段轨迹
  * 门架/卡口查询：时间窗明细
  * 告警查询：列表/详情/筛选

2. **告警与处置闭环**

* 告警状态流转：新建、研判中、确认、驳回、已处置
* 证据链查询接口：返回两点事件、距离、时间差、最小可达时间、置信度
* 通知推送：WebSocket/SSE（至少一种）

3. **导出与报表**

* 大数据导出走异步任务：提交导出任务、查询进度、下载链接

4. **鉴权与审计**

* RBAC：交通管理人员/车主/管理员最小三类角色
* 审计：关键查询与导出操作记录

5. **缓存与降级**

* Redis 缓存大屏聚合接口，接口超时可降级使用上次数据并返回“数据延迟”标识。

**可验收交付物**

* 可运行后端服务（含配置模板）
* OpenAPI/Swagger 文档（与前端对齐）
* 关键接口联调通过（大屏刷新、查询、告警详情、处置动作）
* 基础单元测试或可重复验证脚本

---

### 2.5 前端工程师（大屏 + 管理后台 + 车主端MVP）

**最终需要实现的内容**

1. **设计系统落地**

* 主题：Dark Tech（大屏）+ Light Modern（后台/车主端）
* Design Tokens：颜色语义、字号、间距、圆角、阴影、图表规范
* 组件化：指标卡、图表卡、告警列表、筛选器、表格、地图容器

2. **交通监控大屏**

* 30秒刷新（仅更新数据，不重建全页面）
* 地图：至少一级下钻或区域聚焦；支持车流热力/告警点位
* 联动：点击地图/榜单/告警触发右侧详情与趋势切换
* 告警 ticker：滚动展示最新告警，支持展开
* 系统健康态（建议）：显示延迟/积压/接口P95（可由后端提供）

3. **交互式查询工作台**

* 高级筛选（基础条件 + 高级条件）
* 结果表格：分页、列配置（显示/隐藏）、行展开（证据链/轨迹）
* 导出入口：调用后端导出任务（若实现）

4. **离线预测与建议页**

* 展示历史趋势 + 预测曲线（可含置信区间）
* 治理建议卡片：原因、建议动作、预期效果
* 场景模拟（可选亮点）：滑杆模拟“加开车道”等

5. **车主端MVP**

* 路线规划（最短时间/最少费用/避拥堵）
* 常用路线订阅与提醒（可先用站内提示）

**可验收交付物**

* 组件库（至少内部复用）与 tokens 配置
* 大屏、工作台、预测页可稳定展示真实数据
* 页面性能：大屏刷新不卡顿（演示环境可接受）
* 与后端接口联调通过

---

### 2.6 算法/离线工程师（预测与分析）

**最终需要实现的内容**

1. **训练数据集构建**

* 从 MySQL 聚合指标/或 HBase 明细抽取特征（时间、站点属性、近N窗口流量等）
* 清洗缺失、异常值处理

2. **预测模型训练与评估**

* 至少实现一个可解释基线模型（线性回归/GBDT/ARIMA 等）
* 可选增强：LSTM
* 输出评估指标与对比（MAE/RMSE/MAPE）

3. **在线推断接口与结果解释**

* 以服务或脚本形式提供：输入站点 + horizon（15/30/60分钟）输出预测值
* 输出解释：置信区间或风险等级（绿/黄/橙/红）

**可验收交付物**

* 训练脚本/Notebook、特征说明
* 模型产物（文件/参数）与评估报告
* 推断接口约定（输入输出 JSON 样例）

---

### 2.7 DevOps/测试工程师（可由TL或后端兼任）

**最终需要实现的内容**

1. **一键部署与初始化**

* docker-compose 启动：Kafka、Flink、MySQL、HBase（可选）、Redis（可选）、分片代理（可选）
* 初始化脚本：建库建表、导入维表、创建 Topic、加载演示配置

2. **可观测性（建议）**

* 日志采集与关键指标：Kafka积压、Flink延迟、接口P95、HBase写入

3. **测试与验收**

* 功能验收脚本：验证写入/查询/告警/大屏刷新
* 性能验证脚本（简化版）：验证 50条/秒稳定、端到端延迟在可接受范围

**可验收交付物**

* `docker-compose.yml` + 启停脚本 + README（新机器可复现）
* 初始化脚本（DDL、Topic、维表）
* 验收脚本与报告（截图/日志均可）

---

## 3. 全团队统一的验收口径（Definition of Done）

任何模块完成必须满足：

* 可运行：在统一环境启动后可被调用或可被演示
* 可复现：README 清楚说明“如何启动、如何验证、如何制造演示数据/异常数据”
* 可对齐：接口/Schema/DDL 与文档一致，变更有记录
* 可观测：关键日志可定位问题（至少包含 trace_id 或请求标识）

---